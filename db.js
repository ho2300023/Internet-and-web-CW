const sqlite = require('sqlite3');
const db = new sqlite.Database('rakenny.db');

const createUserTable=`CREATE TABLE IF NOT EXISTS USER (
ID INTEGER PRIMARY KEY AUTOINCREMENT,
NAME TEXT NOT NULL,
EMAIL TEXT UNIQUE NOT NULL,
ROLE TEXT NOT NULL,
PASSWORD TEXT NOT NULL,
PHONENUMBER TEXT NOT NULL,
DISABILITY TEXT NOT NULL
)`;

const createGaragesTable=`CREATE TABLE IF NOT EXISTS GARAGES (
GARAGEID INTEGER PRIMARY KEY AUTOINCREMENT,
LOCATION TEXT UNIQUE NOT NULL,
TOTALSLOTS INTEGER NOT NULL,
OCCUPIEDSLOTS INTEGER DEFAULT 0
)`;

const createParkingSlotsTable=`CREATE TABLE IF NOT EXISTS PARKINGSLOTS (
SLOTID TEXT NOT NULL,
GARAGEID INTEGER NOT NULL,
AVAILABILITY TEXT NOT NULL DEFAULT 'empty',
USERID INTEGER,
TIMEPARKED TEXT,
PRIMARY KEY (SLOTID, GARAGEID),
FOREIGN KEY (GARAGEID) REFERENCES GARAGES(GARAGEID),
FOREIGN KEY (USERID) REFERENCES USER(ID)
)`;

module.exports = {
    db,
    createUserTable,
    createGaragesTable,
    createParkingSlotsTable,
};